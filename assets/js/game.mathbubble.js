!function e(t,i,s){function n(r,a){if(!i[r]){if(!t[r]){var h="function"==typeof require&&require;if(!a&&h)return h(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){var i=t[r][1][e];return n(i?i:e)},u,u.exports,e,t,i,s)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}var n=e("./states/boot"),o=s(n),r=e("./states/game"),a=s(r),h=e("./states/menu"),l=s(h),u=e("./states/preloader"),c=s(u),d=e("./states/gameover"),b=s(d),g=window.innerWidth,p=window.innerHeight;g>600&&(g=600),p>g+g/2&&(p=g+g/2);var f=new Phaser.Game(g,p,Phaser.AUTO,"MathBubble-game");f.state.add("boot",new o.default),f.state.add("game",new a.default),f.state.add("menu",new l.default),f.state.add("preloader",new c.default),f.state.add("gameover",new b.default),f.state.start("boot")},{"./states/boot":4,"./states/game":5,"./states/gameover":6,"./states/menu":7,"./states/preloader":8}],2:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(e){function t(e,i,o,r){s(this,t);var a=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,o,"bubble",r)),h=a.game,l=a.game.width,u=a.game.height,c=["s",2,4,6,8,10,12,14,16,18,20,32],d=0,b=c.length-1;a.number=c[h.rnd.integerInRange(d,b)];var g=l/40+"px Arial",p={font:g,fill:"#ffffff",wordWrap:!0,wordWrapWidth:a.width};return a.width=l/15,a.height=u/15,a.anchor.set(.5,.5),a.tint=a.colorType(h.rnd.integerInRange(0,100)),6750054===a.tint&&(a.number=128),a.label=h.add.text(0,0,a.number,p),a.label.anchor.set(.5,.5),a.beingDragged=!1,a}return o(t,e),r(t,[{key:"update",value:function(){this.label.x=Math.floor(this.x),this.label.y=Math.floor(this.y)}},{key:"resetPosition",value:function(){this.position.y=g.height}},{key:"colorType",value:function(e){return e>=0&&e<49?3358719:e>=49&&e<98?16737894:6750054}}]),t}(Phaser.Sprite);i.default=a},{}],3:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(e){function t(e,i,o,r,a,h){s(this,t);var l=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,o,"r",r));return console.log(a,h),l.anchor.setTo(h,1),l.scale.setTo(2),l}return o(t,e),r(t,[{key:"update",value:function(){}}]),t}(Phaser.Sprite);i.default=a},{}],4:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(e){function t(){return s(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"preload",value:function(){this.load.image("preloader","../assets/mathbubble/preloader.gif")}},{key:"create",value:function(){this.game.input.maxPointers=1,this.game.device.desktop?this.game.scale.pageAlignHorizontally=!0:(this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.minWidth=240,this.game.scale.minHeight=520,this.game.scale.maxWidth=320,this.game.scale.maxHeight=960,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0,this.game.scale.updateLayout(!0)),this.initGlobalVariables(),console.log(this.game.width,this.game.height),this.game.state.start("preloader")}},{key:"initGlobalVariables",value:function(){this.game.global={}}}]),t}(Phaser.State);i.default=a},{}],5:[function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),h=e("../prefabs/bubble"),l=s(h),u=e("../prefabs/leftRight"),c=(s(u),function(e){function t(){return n(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return r(t,e),a(t,[{key:"create",value:function(){this.game.physics.startSystem(Phaser.Physics.P2JS),this.game.physics.p2.setImpactEvents(!0),this.game.physics.p2.restitution=.4,this.game.physics.p2.gravity.y=1e3,this.bubbleCG=this.game.physics.p2.createCollisionGroup(),this.bumperCG=this.game.physics.p2.createCollisionGroup(),this.containerCG=this.game.physics.p2.createCollisionGroup(),this.game.physics.p2.updateBoundsCollisionGroup(),this.leftNumber=0,this.rightNumber=0,this.bubbles=this.game.add.group(),this.rectL=this.game.add.sprite(this.game.width/8,this.game.height/8,"r"),this.rectL.anchor.setTo(0,0),this.rectL.width=this.game.width/4,this.rectL.height=this.game.height/4,this.rectL.tint=10066431,this.game.physics.p2.enable(this.rectL,!1),this.rectL.body.setCollisionGroup(this.bumperCG),this.rectL.body.collides([this.bubbleCG,this.bumperCG]),this.rectL.body.kinematic=!0,this.rectR=this.game.add.sprite(this.game.width-this.game.width/8,this.game.height/8,"r"),this.rectR.anchor.setTo(1,0),this.rectR.width=this.game.width/4,this.rectR.height=this.game.height/4,this.rectR.tint=16751001,this.game.physics.p2.enable(this.rectR,!1),this.rectR.body.setCollisionGroup(this.bumperCG),this.rectR.body.collides([this.bubbleCG,this.bumperCG]),this.rectR.body.kinematic=!0,this.mid=this.game.add.sprite(this.game.width/2,this.game.height-this.game.height/2,"bott"),this.mid.width=this.game.width-4*this.game.width/8,this.game.physics.p2.enable(this.mid,!1),this.mid.body.setCollisionGroup(this.containerCG),this.mid.body.collides([this.bubbleCG,this.containerCG]),this.mid.body.kinematic=!0,this.mid.body.velocity.x=100,this.sideR=this.game.add.sprite(this.game.width-4*this.game.width/11,this.game.height-this.game.height/10,"side"),this.sideR.height=this.game.height-7*this.game.height/8,this.game.physics.p2.enable(this.sideR,!1),this.sideR.body.setCollisionGroup(this.containerCG),this.sideR.body.collides([this.bubbleCG,this.containerCG]),this.sideR.body.kinematic=!0,this.sideR.body.angle=80,this.sideR2=this.game.add.sprite(this.game.width-this.game.width/7,this.game.height-this.game.height/15,"side"),this.sideR2.height=this.game.height-3*this.game.height/7,this.game.physics.p2.enable(this.sideR2,!1),this.sideR2.body.setCollisionGroup(this.containerCG),this.sideR2.body.collides([this.bubbleCG,this.containerCG]),this.sideR2.body.kinematic=!0,this.sideR2.body.angle=50,this.sideR3=this.game.add.sprite(this.game.width-2*this.game.width/9,this.game.height-this.game.height/6,"side"),this.sideR3.height=this.game.height-8*this.game.height/11,this.game.physics.p2.enable(this.sideR3,!1),this.sideR3.body.setCollisionGroup(this.containerCG),this.sideR3.body.collides([this.bubbleCG,this.containerCG]),this.sideR3.body.kinematic=!0,this.sideR3.body.angle=50,this.sideR4=this.game.add.sprite(this.game.width-this.game.width/30,this.game.height-8*this.game.height/18,"side"),this.sideR4.height=this.game.height-7*this.game.height/11,this.game.physics.p2.enable(this.sideR4,!1),this.sideR4.body.setCollisionGroup(this.containerCG),this.sideR4.body.collides([this.bubbleCG,this.containerCG]),this.sideR4.body.kinematic=!0,this.sideR4.body.angle=-30,this.sideL=this.game.add.sprite(4*this.game.width/11,this.game.height-this.game.height/10,"side"),this.sideL.height=this.game.height-7*this.game.height/8,this.game.physics.p2.enable(this.sideL,!1),this.sideL.body.setCollisionGroup(this.containerCG),this.sideL.body.collides([this.bubbleCG,this.containerCG]),this.sideL.body.kinematic=!0,this.sideL.body.angle=-80,this.sideL2=this.game.add.sprite(this.game.width/7,this.game.height-this.game.height/15,"side"),this.sideL2.height=this.game.height-3*this.game.height/7,this.game.physics.p2.enable(this.sideL2,!1),this.sideL2.body.setCollisionGroup(this.containerCG),this.sideL2.body.collides([this.bubbleCG,this.containerCG]),this.sideL2.body.kinematic=!0,this.sideL2.body.angle=-50,this.sideL3=this.game.add.sprite(2*this.game.width/9,this.game.height-this.game.height/6,"side"),this.sideL3.height=this.game.height-8*this.game.height/11,this.game.physics.p2.enable(this.sideL3,!1),this.sideL3.body.setCollisionGroup(this.containerCG),this.sideL3.body.collides([this.bubbleCG,this.containerCG]),this.sideL3.body.kinematic=!0,this.sideL3.body.angle=-50,this.sideL4=this.game.add.sprite(this.game.width/30,this.game.height-8*this.game.height/18,"side"),this.sideL4.height=this.game.height-7*this.game.height/11,this.game.physics.p2.enable(this.sideL4,!1),this.sideL4.body.setCollisionGroup(this.containerCG),this.sideL4.body.collides([this.bubbleCG,this.containerCG]),this.sideL4.body.kinematic=!0,this.sideL4.body.angle=30,this.mouseBody=new p2.Body,this.game.physics.p2.world.addBody(this.mouseBody),this.game.input.onDown.add(this.startDrag,this),this.game.input.onUp.add(this.stopDrag,this),this.game.input.addMoveCallback(this.movePointer,this),this.timedLoop=0,this.timedCounter=1500,this.time=0,this.angleTimeout=0,this.angleCounter=5e3,this.angularVelocity=.2,this.gameOver=0}},{key:"createBubble",value:function(){var e=this.game,t=e.width,i=e.height,s=e.rnd.integerInRange(-150,150);this.bubbly=new l.default(e,t/2+s,i-i/5,0),e.physics.p2.enable(this.bubbly,!1),this.bubbly.body.setCircle(e.width/30),this.bubbly.body.setCollisionGroup(this.bubbleCG),this.bubbly.body.collides([this.bubbleCG,this.bumperCG,this.containerCG]),this.bubbly.body.createBodyCallback(this.rectL,this.hitBumper,this),this.bubbly.body.createBodyCallback(this.rectR,this.hitBumper,this),e.add.existing(this.bubbly),this.bubbles.add(this.bubbly),42===this.bubbles.length?(this.timedCounter=100,this.timedLoop=this.time):150===this.bubbles.length?(this.sideL2.destroy(),this.sideL3.destroy(),this.sideL4.destroy(),this.sideR2.destroy(),this.sideR3.destroy(),this.sideR4.destroy(),this.sideR.destroy(),this.sideL.destroy()):this.bubbles.length>200&&e.state.start("game")}},{key:"update",value:function(){this.mid.body.angle+=1,(this.mid.x>this.game.width-this.game.width/4||this.mid.x<this.game.width/4)&&(this.mid.body.velocity.x*=-1),this.sideL4.body.angle+=this.angularVelocity,this.sideR4.body.angle-=this.angularVelocity,this.angleTimeout<this.time&&(console.log("here",this.angularVelocity),this.angleTimeout=this.time+this.angleCounter,this.angularVelocity*=-1),this.time=this.game.time.now,this.timedLoop<this.time&&(this.timedIncrease=Math.abs(this.leftNumber-this.rightNumber),this.timedLoop=this.time+(this.timedCounter-this.timedIncrease),this.timedCounter-=5,this.createBubble())}},{key:"startDrag",value:function(e){var t=[];this.bubbles.forEach(function(e){t.push(e.body)},this);var i=this.game.physics.p2.hitTest(e.position,t),s=[this.game.physics.p2.pxmi(e.position.x),this.game.physics.p2.pxmi(e.position.y)];if(i.length){var n=i[0],o=[0,0];n.toLocalFrame(o,s),n.parent.sprite.beingDragged=!0,console.log(n,n.parent.sprite),this.mouseConstraint=this.game.physics.p2.createRevoluteConstraint(this.mouseBody,[0,0],n,[this.game.physics.p2.mpxi(o[0]),this.game.physics.p2.mpxi(o[1])])}}},{key:"hitBumper",value:function(e,t){console.log(e.sprite.beingDragged,e.sprite.label.text),e.sprite.label.text="",console.log(e.sprite.label),e.sprite.beingDragged&&this.stopDrag(),t.sprite===this.rectL?this.hitLeft(e.sprite.number,e.sprite.tint):this.hitRight(e.sprite.number,e.sprite.tint),e.sprite.destroy()}},{key:"stopDrag",value:function(e,t){this.game.physics.p2.removeConstraint(this.mouseConstraint),void 0!==this.mouseConstraint&&null!==this.mouseConstraint.bodyB.parent.sprite&&(this.mouseConstraint.bodyB.parent.sprite.beingDragged=!1)}},{key:"movePointer",value:function(e){this.mouseBody.position[0]=this.game.physics.p2.pxmi(e.position.x),this.mouseBody.position[1]=this.game.physics.p2.pxmi(e.position.y)}},{key:"hitLeft",value:function(e,t){3358719===t?this.leftNumber+="s"!==e?e:this.game.rnd.integerInRange(0,50):6750054===t?(this.leftNumber+="s"!==e?e:this.game.rnd.integerInRange(0,50),this.rightNumber-="s"!==e?e/2:this.game.rnd.integerInRange(0,50)):this.rightNumber-="s"!==e?e:this.game.rnd.integerInRange(0,50),console.log("score ",this.leftNumber,this.rightNumber,"bubble count: ",this.bubbles.length),this.leftNumber===this.rightNumber&&this.createBubble()}},{key:"hitRight",value:function(e,t){3358719===t?this.leftNumber-="s"!==e?e:this.game.rnd.integerInRange(0,50):6750054===t?(this.rightNumber+="s"!==e?e:this.game.rnd.integerInRange(0,50),this.leftNumber-="s"!==e?e/2:this.game.rnd.integerInRange(0,50)):this.rightNumber+="s"!==e?e:this.game.rnd.integerInRange(0,50),console.log("score",this.leftNumber,this.rightNumber,"bubble count: ",this.bubbles.length),this.leftNumber===this.rightNumber&&this.createBubble()}},{key:"endGame",value:function(){this.game.state.start("gameover")}}]),t}(Phaser.State));i.default=c},{"../prefabs/bubble":2,"../prefabs/leftRight":3}],6:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(e){function t(){return s(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"create",value:function(){var e=this.add.text(.5*this.game.width,.5*this.game.height,"Gameover",{font:"42px Arial",fill:"#ffffff",align:"center"});e.anchor.set(.5),this.saveVarsToLocalStorage(),this.input.onDown.add(this.restartGame,this)}},{key:"saveVarsToLocalStorage",value:function(){}},{key:"resetGlobalVariables",value:function(){}},{key:"update",value:function(){}},{key:"restartGame",value:function(){this.resetGlobalVariables(),this.game.state.start("menu")}}]),t}(Phaser.State);i.default=a},{}],7:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(e){function t(){return s(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"create",value:function(){var e=this.add.text(.5*this.game.width,.5*this.game.height,"MENU",{font:"42px Arial",fill:"#ffffff",align:"center"});e.anchor.set(.5),this.input.onDown.add(this.startGame,this)}},{key:"update",value:function(){}},{key:"startGame",value:function(){this.game.state.start("game")}}]),t}(Phaser.State);i.default=a},{}],8:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),a=function(e){function t(){s(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.asset=null,e.ready=!1,e}return o(t,e),r(t,[{key:"preload",value:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.setPreloadSprite(this.asset),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.loadResources()}},{key:"update",value:function(){this.ready&&this.game.state.start("game")}},{key:"loadResources",value:function(){this.game.load.image("bubble","../assets/mathbubble/bubble.png"),this.game.load.image("r","../assets/mathbubble/rectangle.png"),this.game.load.image("side","../assets/mathbubble/side.png"),this.game.load.image("bott","../assets/mathbubble/bottom.png")}},{key:"onLoadComplete",value:function(){this.ready=!0}}]),t}(Phaser.State);i.default=a},{}]},{},[1]);
